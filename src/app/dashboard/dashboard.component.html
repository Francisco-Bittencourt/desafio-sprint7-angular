<div class="d-flex min-vh-100">
  <nav class="sidebar bg-light p-3 shadow-sm d-none flex-column align-items-center">
    <img src="/img/ford.png" class="img-fluid mb-4" alt="Logo Ford" style="max-width: 80%;" />
    <ul class="navbar-nav flex-column w-100 mt-3">
      <li class="nav-item mb-2 text-center">
        <a (click)="toHome()" class="nav-link" aria-current="page" style="cursor: pointer;">Home</a>
      </li>
      <li class="nav-item mb-2 text-center">
        <a routerLink="/dashboard" class="nav-link">Dashboard</a>
      </li>
      <li class="nav-item mb-2 text-center">
        <a routerLink="/test-drive" class="nav-link">Test Drive</a>
      </li>
     
    </ul>
    <div class="mt-auto w-100 text-center pb-3">
      <a (click)="toLogout()" class="nav-link" style="cursor: pointer;">Sair</a>
    </div>
  </nav>

  <button class="fab-menu-button" type="button"
            data-bs-toggle="offcanvas" data-bs-target="#offcanvasNavbar"
            aria-controls="offcanvasNavbar" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasNavbar" aria-labelledby="offcanvasNavbarLabel">
    <div class="offcanvas-header bg-light d-flex flex-column align-items-center">
      <img src="/img/ford.png" class="img-fluid mb-3" alt="Logo Ford" style="max-width: 70%;" />
      <h5 class="offcanvas-title" id="offcanvasNavbarLabel">Menu</h5>
      <button type="button" class="btn-close position-absolute top-0 end-0 m-3" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body">
      <ul class="navbar-nav flex-column w-100">
        <li class="nav-item mb-2 text-center">
          <a (click)="toHome()" class="nav-link" aria-current="page" style="cursor: pointer;">Home</a>
        </li>
        <li class="nav-item mb-2 text-center">
          <a routerLink="/dashboard" class="nav-link">Dashboard</a>
        </li>
        <li class="nav-item mb-2 text-center">
          <a routerLink="/test-drive" class="nav-link">Test Drive</a>
        </li>
       
      </ul>
      <div class="mt-auto w-100 text-center pb-3">
        <a (click)="toLogout()" class="nav-link" style="cursor: pointer;">Sair</a>
      </div>
    </div>
  </div>

  <div class="container-fluid p-4 bg-light-subtle flex-grow-1 overflow-auto">
    <h1 class="text-center text-primary mb-4 fw-bold fs-3 text-uppercase">Dashboard FORD</h1>

    <div class="row row-cols-1 row-cols-md-2 row-cols-lg-4 g-3 mb-4">
      <div class="col">
        <div class="card h-100 shadow-sm text-center p-3">
          <h5 class="card-subtitle mb-2 text-muted">Veículo</h5>
          <div class="card-body p-0">
            <form [formGroup]="selectCarForms">
              <select class="form-select" formControlName="carId">
                <option value="">Selecione um veículo</option>
                <option *ngFor="let vehicle of vehicles" [value]="vehicle.id">
                  {{ vehicle.vehicle }}
                </option>
              </select>
            </form>
          </div>
        </div>
      </div>

      <div class="col">
        <div class="card h-100 shadow-sm text-center p-3">
          <h5 class="card-subtitle mb-2 text-muted">Total de Vendas</h5>
          <div class="card-body p-0">
            <p class="card-text fw-bold fs-4 mb-0">{{ totalSales | number }} <small class="text-muted fw-normal">Unid</small></p>
          </div>
        </div>
      </div>

      <div class="col">
        <div class="card h-100 shadow-sm text-center p-3">
          <h5 class="card-subtitle mb-2 text-muted">Conectados</h5>
          <div class="card-body p-0">
            <p class="card-text fw-bold fs-4 mb-0">{{ connectedVehicles | number }} <small class="text-muted fw-normal">Unid</small></p>
          </div>
        </div>
      </div>

      <div class="col">
        <div class="card h-100 shadow-sm text-center p-3">
          <h5 class="card-subtitle mb-2 text-muted">Update Software</h5>
          <div class="card-body p-0">
            <p class="card-text fw-bold fs-4 mb-0">{{ softwareUpdates | number }} <small class="text-muted fw-normal">Unid</small></p>
          </div>
        </div>
      </div>
    </div>

    <div class="text-center mb-4">
      <img
        *ngIf="selectedVehicle"
        [src]="selectedVehicle.img"
        alt="Ford {{ selectedVehicle.vehicle }}"
        class="img-fluid rounded shadow-lg"
        style="max-width: 40%; height: auto;"
      />
    </div>

    <div class="bg-white rounded shadow-sm p-3 mb-4">
      <h5 class="card-subtitle mb-2 text-muted text-center">Buscar por VIN</h5>
      <form [formGroup]="selectCarForms" class="d-flex justify-content-center">
        <input
          type="text"
          formControlName="vin"
          placeholder="Digite o VIN e Enter"
          (keydown.enter)="loadVehicleDetails()"
          class="form-control me-2"
          style="max-width: 300px;"
        />
        <button type="button" class="btn btn-primary" (click)="loadVehicleDetails()">Buscar</button>
      </form>
    </div>

    <div class="d-md-none bg-white rounded shadow-sm p-3">
      <h5 class="text-center mb-3">Detalhes do Veículo</h5>
      <div *ngIf="vehicleData">
        <ul class="list-group list-group-flush">
          <li class="list-group-item"><strong>VIN:</strong> {{ selectCarForms.controls.vin.value }}</li>
          <li class="list-group-item"><strong>Odômetro:</strong> {{ vehicleData.odometro | number }} Km</li>
          <li class="list-group-item"><strong>Nível de Combustível:</strong> {{ vehicleData.nivelCombustivel }}%</li>
          <li class="list-group-item"><strong>Status:</strong> {{ vehicleData.status === "on" ? "Ligado" : "Desligado" }}</li>
          <li class="list-group-item"><strong>Latitude:</strong> {{ vehicleData.lat }}</li>
          <li class="list-group-item"><strong>Longitude:</strong> {{ vehicleData.long }}</li>
        </ul>
      </div>
      <div *ngIf="!vehicleData && !selectCarForms.controls.vin.value" class="text-center p-4 text-muted">
        Selecione um veículo ou digite um VIN para ver os detalhes.
      </div>
      <div *ngIf="!vehicleData && selectCarForms.controls.vin.value" class="text-center p-4 text-danger">
        Dados não encontrados para o VIN digitado.
      </div>
    </div>

    <div class="table-responsive bg-white rounded shadow-sm p-3 d-none d-md-block">
      <table class="table table-striped table-hover mb-0">
        <thead>
          <tr>
            <th scope="col">Código - Vin</th>
            <th scope="col">Odômetro</th>
            <th scope="col">Nível de Combustível</th>
            <th scope="col">Status</th>
            <th scope="col">Lat</th>
            <th scope="col">Long</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngIf="!vehicleData && !selectCarForms.controls.vin.value">
            <td colspan="6" class="text-center p-4 text-muted">
              Selecione um veículo para ver os detalhes ou digite um VIN.
            </td>
          </tr>
          <tr *ngIf="!vehicleData && selectCarForms.controls.vin.value">
            <td colspan="6" class="text-center p-4 text-danger">
              Dados não encontrados para o VIN digitado.
            </td>
          </tr>
          <tr *ngIf="vehicleData">
            <td>{{ selectCarForms.controls.vin.value }}</td>
            <td>{{ vehicleData.odometro | number }} Km</td>
            <td>{{ vehicleData.nivelCombustivel }}%</td>
            <td>{{ vehicleData.status === "on" ? "Ligado" : "Desligado" }}</td>
            <td>{{ vehicleData.lat }}</td>
            <td>{{ vehicleData.long }}</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="text-center mt-4">
      <a routerLink="/test-drive" class="btn btn-primary btn-lg me-2">Agende seu Test Drive</a>
      
      <a routerLink="/comparacao-veiculos" class="btn btn-info btn-lg">Comparação de Veículos</a>
      
    </div>
    </div>
</div>
